# Excel Export Field Reference

## Quick Reference: All 18 Exported Fields

### ğŸ“‹ Column Layout

```
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Col â”‚ Field Name                   â”‚ Description & Example                â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  A  â”‚ Event Title                  â”‚ Article headline                     â”‚
â”‚     â”‚                              â”‚ "Bomb blast kills 5 in Kabul"        â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  B  â”‚ Summary                      â”‚ 1-2 sentence summary                 â”‚
â”‚     â”‚                              â”‚ "A suicide bombing near Kabul..."    â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  C  â”‚ Event Type                   â”‚ Category: BOMBING, ATTACK, PROTEST   â”‚
â”‚     â”‚                              â”‚ "BOMBING"                            â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  D  â”‚ Perpetrator                  â”‚ Who carried out the event            â”‚
â”‚     â”‚                              â”‚ "Taliban", "Unknown", or empty       â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  E  â”‚ Location (Full Text)         â”‚ Complete location string             â”‚
â”‚     â”‚                              â”‚ "Kabul, Kabul Province, Afghanistan" â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  F  â”‚ City                         â”‚ Parsed city name                     â”‚
â”‚     â”‚                              â”‚ "Kabul"                              â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  G  â”‚ Region/State                 â”‚ Parsed region/state/province         â”‚
â”‚     â”‚                              â”‚ "Kabul Province"                     â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  H  â”‚ Country                      â”‚ Parsed country                       â”‚
â”‚     â”‚                              â”‚ "Afghanistan"                        â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  I  â”‚ Event Date                   â”‚ When event occurred (YYYY-MM-DD)     â”‚
â”‚     â”‚                              â”‚ "2023-01-02"                         â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  J  â”‚ Event Time                   â”‚ Time of day if available             â”‚
â”‚     â”‚                              â”‚ "09:30", "morning", or empty         â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  K  â”‚ Individuals Involved         â”‚ Comma-separated list of people       â”‚
â”‚     â”‚                              â”‚ "John Doe, Jane Smith"               â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  L  â”‚ Organizations Involved       â”‚ Comma-separated list of orgs         â”‚
â”‚     â”‚                              â”‚ "Taliban, UN, Red Cross"             â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  M  â”‚ Casualties (Killed)          â”‚ Number of people killed              â”‚
â”‚     â”‚                              â”‚ "5" or empty if not mentioned        â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  N  â”‚ Casualties (Injured)         â”‚ Number of people injured             â”‚
â”‚     â”‚                              â”‚ "12" or empty if not mentioned       â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  O  â”‚ Source Name                  â”‚ News source                          â”‚
â”‚     â”‚                              â”‚ "BBC News", "Reuters", "CNN"         â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  P  â”‚ Source URL                   â”‚ Article link (hyperlinked)           â”‚
â”‚     â”‚                              â”‚ "https://bbc.com/news/..."           â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Q  â”‚ Article Publication Date     â”‚ When article was published           â”‚
â”‚     â”‚                              â”‚ "2023-01-03"                         â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  R  â”‚ Extraction Confidence        â”‚ Quality score (0-100%)               â”‚
â”‚     â”‚                              â”‚ "85%"                                â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Field Mapping

### **From LLM Response:**

```json
{
  "event_type": "bombing",                    â†’ Column C
  "summary": "Brief description...",          â†’ Column B
  "perpetrator": "Taliban",                   â†’ Column D
  "location": {
    "city": "Kabul",                          â†’ Column F
    "region": "Kabul Province",               â†’ Column G
    "country": "Afghanistan"                  â†’ Column H
  },
  "event_date": "2023-01-02",                 â†’ Column I
  "event_time": "09:30",                      â†’ Column J
  "individuals": ["Person A", "Person B"],    â†’ Column K
  "organizations": ["Taliban", "UN"],         â†’ Column L
  "casualties": {
    "killed": 5,                              â†’ Column M
    "injured": 12                             â†’ Column N
  },
  "confidence": 0.85                          â†’ Column R
}
```

### **From Article Metadata:**

```python
article.title                â†’ Column A (Event Title)
article.source_name          â†’ Column O (Source Name)
article.url                  â†’ Column P (Source URL)
article.published_date       â†’ Column Q (Article Publication Date)
```

### **From Combined Location:**

```python
str(location)  â†’ Column E (Location Full Text)
# Combines: "Kabul, Kabul Province, Afghanistan"
```

---

## ğŸ“Š Data Types

| Column | Type | Format | Nullable |
|--------|------|--------|----------|
| A | String | Text | No |
| B | String | Text | No |
| C | Enum | UPPERCASE_WORDS | No |
| D | String | Text | Yes |
| E | String | "City, Region, Country" | Yes |
| F | String | Text | Yes |
| G | String | Text | Yes |
| H | String | Text | Yes |
| I | Date | YYYY-MM-DD | Yes |
| J | String | HH:MM or text | Yes |
| K | String | Comma-separated | Yes |
| L | String | Comma-separated | Yes |
| M | Integer | Number | Yes |
| N | Integer | Number | Yes |
| O | String | Text | Yes |
| P | URL | Hyperlinked text | Yes |
| Q | Date | YYYY-MM-DD | Yes |
| R | Percentage | XX% | No |

---

## ğŸ” Field Validation Rules

### **Event Title (A)**
- âœ… Must be non-empty
- âœ… Taken from article headline
- âœ… Max recommended: 100 characters

### **Summary (B)**
- âœ… 1-2 sentences
- âœ… Extracted by LLM
- âœ… Max recommended: 300 characters

### **Event Type (C)**
- âœ… Must be valid EventType enum
- âœ… Auto-validated with fuzzy matching
- âœ… Defaults to "OTHER" if unknown

### **Perpetrator (D)**
- âš ï¸ Optional (attacks/bombings only)
- âœ… Can be "Unknown", org name, or null
- âœ… Separate from "Individuals Involved"

### **Location Fields (E, F, G, H)**
- âœ… Full text combines all components
- âœ… Components can be individually null
- âœ… Extracted by LLM from article text

### **Event Date (I)**
- âœ… Format: YYYY-MM-DD
- âœ… Fallback: Article publication date
- âœ… Parsed with multiple format attempts

### **Event Time (J)**
- âš ï¸ Optional
- âœ… Formats: "HH:MM", "morning", "evening", "night"
- âœ… Extracted if mentioned in article

### **Individuals/Organizations (K, L)**
- âœ… Comma-separated lists
- âœ… Combined from LLM + NLP entities
- âœ… Deduplicated

### **Casualties (M, N)**
- âš ï¸ Optional (if numbers mentioned)
- âœ… Integers only
- âœ… Separate killed vs injured counts

### **Source Name (O)**
- âœ… Auto-detected from URL
- âœ… 15+ major sources recognized
- âœ… Fallback: Domain name

### **Source URL (P)**
- âœ… Must be valid URL
- âœ… Hyperlinked in Excel
- âœ… Blue, underlined formatting

### **Article Publication Date (Q)**
- âœ… Format: YYYY-MM-DD
- âœ… Fallback: Event date if missing
- âœ… From article metadata

### **Extraction Confidence (R)**
- âœ… Range: 0% - 100%
- âœ… LLM self-assessment
- âœ… Default: 75% if not provided

---

## ğŸ¨ Excel Styling

### **Header Row**
- Background: Dark Blue (#366092)
- Font: White, Bold, 11pt
- Alignment: Center

### **Data Rows**
- Zebra striping: Alternating light gray (#F2F2F2)
- Font: Regular, 10pt
- Alignment: Top-left, wrap text

### **Special Formatting**
- **Event Title (A)**: Bold
- **Source URL (P)**: Blue (#0563C1), underlined, hyperlinked

### **Column Widths**
- Event Title: 40
- Summary: 60
- Location (Full): 35
- Others: Auto-adjusted (10-30)

---

## ğŸ”„ Processing Pipeline

```
1. Article Scraped
   â†“
2. Extract metadata (title, URL, date, source)
   â†“
3. NLP entity extraction (spaCy)
   â†“
4. LLM event extraction (Ollama)
   â†“
5. Parse LLM JSON response
   â†“
6. Enrich with entities
   â†“
7. Apply fallbacks for missing data
   â†“
8. Create EventData object (18 fields)
   â†“
9. Format for Excel
   â†“
10. Apply styling
   â†“
11. Export .xlsx file
```

---

## âœ… Quality Checklist

Before accepting extraction results:

- [ ] **All 18 columns present** in Excel export
- [ ] **Event Title** populated for all rows
- [ ] **Event Type** is valid enum (not "OTHER" for all)
- [ ] **Location** has at least one component (city, region, or country)
- [ ] **Event Date** in correct format (YYYY-MM-DD)
- [ ] **Source Name** identified (not just URL)
- [ ] **Confidence** between 0-100%
- [ ] **Casualties** extracted if mentioned in article
- [ ] **Hyperlinks** working on Source URL column
- [ ] **No critical fields** completely empty across all events

---

## ğŸ“ˆ Expected Completion Rates

| Field | Typical Fill Rate |
|-------|------------------|
| Event Title | 100% |
| Summary | 100% |
| Event Type | 100% |
| Perpetrator | 40-60% (attack events only) |
| Location (Full) | 95% |
| City | 80-90% |
| Region/State | 60-70% |
| Country | 90-95% |
| Event Date | 95% |
| Event Time | 30-50% |
| Individuals Involved | 70-85% |
| Organizations Involved | 60-80% |
| Casualties (Killed) | 40-60% (attack events) |
| Casualties (Injured) | 40-60% (attack events) |
| Source Name | 100% |
| Source URL | 100% |
| Article Publication Date | 95% |
| Extraction Confidence | 100% |

---

**Reference Version**: 2.0  
**Last Updated**: December 6, 2025  
**For**: Production Event Extraction System
